import{a as d,b as N,d as F}from"./chunk-B7M7KWVX.js";import{s as E}from"./chunk-PK2RARDK.js";import{Da as v,Z as c,ca as o,da as p,o as S,p as g,sa as I,yb as T}from"./chunk-ELCUH6OG.js";import{a as h,b as u,f as n,g as l,h as f}from"./chunk-IGH4DTA6.js";var j=(()=>{var t;let r=class r{constructor(){l(this,t,E(o(v)))}getItem(i){return n(this,t)?localStorage.getItem(i):null}setItem(i,a){n(this,t)&&localStorage.setItem(i,a)}removeItem(i){n(this,t)&&localStorage.removeItem(i)}};t=new WeakMap,r.\u0275fac=function(a){return new(a||r)},r.\u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"});let s=r;return s})();var R=(()=>{let t=class t{constructor(){this.localStorage=o(j),this.CURRENT_SETTINGS_VERSION=1,this.SETTINGS_STORAGE_KEY="coral-guide-settings",this.DEFAULT_SETTINGS={version:this.CURRENT_SETTINGS_VERSION,useBeta:!1,language:"en"}}saveSettings(e){let i=h(h({},this.DEFAULT_SETTINGS),e);this.localStorage.setItem(this.SETTINGS_STORAGE_KEY,JSON.stringify(i)),this._settings=i}getSettings(){let e=this.localStorage.getItem(this.SETTINGS_STORAGE_KEY);if(!e)this.saveSettings(this.DEFAULT_SETTINGS);else if(!this._settings){let i=JSON.parse(e);this._settings=this._migrate(i)}return this._settings}_migrate(e){if(!e.version){let i=u(h({},this.DEFAULT_SETTINGS),{useBeta:!!e.useBeta});return this.saveSettings(i),i}return e}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"});let s=t;return s})();var A=(()=>{var t,r;let e=class e{constructor(){l(this,t);l(this,r);this.value=I(""),f(this,t,o(d)),f(this,r,o(R).getSettings().useBeta?"beta":"live")}value$(){let a=n(this,t);return S(a.get(`assets/${n(this,r)}/version.json?t=${new Date().toISOString()}`).pipe(g(m=>(this.value.set(m.version),m.version))))}};t=new WeakMap,r=new WeakMap,e.\u0275fac=function(m){return new(m||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})(),P=()=>p([N(F()),T(()=>(t=>()=>t.value$())(o(A))())]);export{j as a,R as b,A as c,P as d};
