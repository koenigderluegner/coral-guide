import{a as I,b as ae}from"./chunk-7BF7QRGV.js";import"./chunk-BYXBJQAS.js";import{a as re}from"./chunk-LIXY5VCQ.js";import{a as pe,b as ce}from"./chunk-2ZIFYFNC.js";import"./chunk-KF55ZM64.js";import"./chunk-7WGFHFIM.js";import{a as le}from"./chunk-A4HPUO3F.js";import"./chunk-OKR7QHIK.js";import{a as oe}from"./chunk-5PS4YV7K.js";import"./chunk-L5XZOWBG.js";import"./chunk-L5G7Q7YK.js";import"./chunk-QCMAEIDU.js";import"./chunk-VIB7IWHD.js";import"./chunk-YIG7AZUO.js";import"./chunk-H5W4AT7W.js";import"./chunk-CS6UDEWJ.js";import"./chunk-5UJ33BDI.js";import"./chunk-YRO3XTLN.js";import"./chunk-BP5TLU4W.js";import"./chunk-EGGJNKID.js";import"./chunk-NOBC57G4.js";import"./chunk-BVOEAINN.js";import"./chunk-NTEY2CKU.js";import"./chunk-3H2ZASFZ.js";import"./chunk-OYPR7CJS.js";import"./chunk-QYM5RSKG.js";import{b as ee,c as te}from"./chunk-CMTXHUJM.js";import{a as ie}from"./chunk-ZNXHGMTD.js";import"./chunk-IBXLELUQ.js";import{b as ne}from"./chunk-SNYRKERH.js";import"./chunk-YOD5VGJA.js";import"./chunk-EJRI7FQQ.js";import"./chunk-XMGSTBON.js";import"./chunk-7VKCZCDP.js";import"./chunk-RIQ7EVWM.js";import"./chunk-U65D7S4X.js";import"./chunk-IJY46FI3.js";import{b as W}from"./chunk-CXGH7SOD.js";import"./chunk-D33HMA7I.js";import{a as Z}from"./chunk-VRZECYYF.js";import"./chunk-IIDJZWRT.js";import"./chunk-7MFI6IJ7.js";import"./chunk-HIFLNZD5.js";import{a as X}from"./chunk-ZALICU3N.js";import"./chunk-47OJ7DES.js";import{a as z}from"./chunk-SAY5CNC2.js";import"./chunk-BFCDBX46.js";import"./chunk-G2FIETR4.js";import"./chunk-7DQT77OQ.js";import{i as Y}from"./chunk-OHR5KDYC.js";import{Dc as J,Hb as _,Jb as C,Lb as O,Lc as S,Mb as Q,Mc as V,Nb as U,Ob as g,Pb as m,Qb as c,Rb as u,S as k,Sc as w,Yb as j,Za as o,_c as R,ac as T,ca as M,cc as s,ia as D,ja as N,k as E,kb as A,kc as H,lc as K,mc as F,ob as B,oc as q,qb as L,rc as b,sa as $,tc as G,v as P}from"./chunk-FPTGDBQG.js";import{d as p,e as h,f as v}from"./chunk-2QKSPLSF.js";function se(t,i){if(t&1&&u(0,"app-offering",4),t&2){let e=i.$implicit;g("details",e)}}function de(t,i){if(t&1&&(m(0,"app-item-card-switch",1),L(1,se,1,1,"ng-template",3),c()),t&2){let e=s();g("item",e.selectedEntity)}}function fe(t,i){if(t&1&&u(0,"app-ui-icon",13),t&2){let e=s(2).$implicit,n=s(2);g("matTooltip",J("",e.npc==null?null:e.npc.characterName," is dateable"))("uiIcon",n.uiIcon.LOVE)}}function _e(t,i){if(t&1&&(m(0,"div",14),u(1,"app-ui-icon",15),b(2),S(3,"ingameDate"),c()),t&2){let e=s(2).$implicit,n=s(2);o(),g("uiIcon",n.uiIcon.BIRTHDAY),o(),G(" ",V(3,2,e.npc.birthday)," ")}}function Ce(t,i){if(t&1&&(u(0,"app-item-icon",10),m(1,"div",11)(2,"div",12),b(3),_(4,fe,1,3,"app-ui-icon",13),c(),_(5,_e,4,4,"div",14),c()),t&2){let e=s().$implicit;g("itemName",e.preferences.npc.iconName),o(3),G(" ",e.preferences.npc.characterName," "),o(),C(e.npc!=null&&e.npc.isDateable?4:-1),o(),C(e.npc&&e.npc.birthday?5:-1)}}function ge(t,i){t&1&&b(0," Universal ")}function ue(t,i){if(t&1){let e=j();m(0,"app-expandable",5,0)(2,"div",6),T("click",function(){D(e);let r=F(1);return N(r.toggle())}),m(3,"div",7),_(4,Ce,6,4),_(5,ge,1,0),c(),u(6,"i",8),c(),m(7,"app-gifting-grid",9),T("itemClicked",function(r){D(e);let d=s(2);return N(d.showDetails(r))}),c()()}if(t&2){let e=i.$implicit,n=F(1);o(4),C(e.preferences.npc?4:-1),o(),C(e.preferences.mapKey==="ci_universal"?5:-1),o(),q("down",!n.isOpen())("translate-y-[-3px]",n.isOpen())("up",n.isOpen()),o(),g("preferences",e.preferences)}}function xe(t,i){if(t&1&&(m(0,"app-card",2),Q(1,ue,8,9,"app-expandable",5,O),c()),t&2){let e=s();o(),U(e.filteredAndSortedNpcs())}}var Qe=(()=>{var i,e,n,r,d;let x=class x extends te{constructor(){super();h(this,i);h(this,e);h(this,n);h(this,r);h(this,d);this.npcFilter=R(I),this.uiIcon=z,v(this,i,w(()=>this.npcFilter()?.searchValueChanges()??"")),v(this,e,w(()=>this.npcFilter()?.sortValueChanges()??"default")),v(this,n,ae),v(this,r,$(void 0)),this.filteredAndSortedNpcs=w(()=>{let f=p(this,r).call(this)??[];if(!p(this,i)||!p(this,e))return f;let a=p(this,i).call(this).toLowerCase(),l=p(this,e).call(this);return p(this,n).call(this,f,a,l)}),v(this,d,M(W)),this.gifting$=P({gifts:p(this,d).fetchGiftingPreferences$(),npcs:p(this,d).fetchNPCs$()}).pipe(k(({gifts:f,npcs:a})=>{let l=f.map(y=>({preferences:y,npc:a.find(me=>me.key===y.mapKey)}));return p(this,r)?.set(l),E(l)}))}};i=new WeakMap,e=new WeakMap,n=new WeakMap,r=new WeakMap,d=new WeakMap,x.\u0275fac=function(a){return new(a||x)},x.\u0275cmp=A({type:x,selectors:[["app-gifting"]],viewQuery:function(a,l){a&1&&H(l.npcFilter,I,5),a&2&&K()},features:[B],decls:5,vars:4,consts:[["expandableComponent",""],["listDetail","",3,"item"],[1,"text-xl"],["appDatabaseItemDetails",""],[3,"details"],["open","",1,"mb-8"],["expandableHeader","",1,"flex","justify-between","items-center","cursor-pointer",3,"click"],[1,"text-2xl","text-black","font-semibold","flex","items-center","gifting-portrait"],[1,"arrow"],[3,"itemClicked","preferences"],[1,"h-16","mr-3",3,"itemName"],[1,"flex","flex-col"],[1,"flex","gap-2","items-center"],[1,"!text-gifting","!h-6","!w-6",3,"uiIcon","matTooltip"],[1,"text-lg","flex","gap-2"],[1,"!h-6","!w-6",3,"uiIcon"]],template:function(a,l){if(a&1&&(m(0,"app-list-detail-container"),_(1,de,2,1,"app-item-card-switch",1),u(2,"app-npc-filter"),_(3,xe,3,0,"app-card",2),S(4,"async"),c()),a&2){let y;o(),C(l.selectedEntity?1:-1),o(2),C((y=V(4,2,l.gifting$))?3:-1,y)}},dependencies:[re,Z,oe,pe,ee,ce,X,ie,ne,I,le,Y],styles:[`.gifting-portrait .app-item-icon>img{width:auto;height:100%;aspect-ratio:unset}
`],encapsulation:2});let t=x;return t})();export{Qe as GiftingComponent};
