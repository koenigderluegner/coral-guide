import{a as N,b as me}from"./chunk-ENPHFC7B.js";import"./chunk-BYXBJQAS.js";import{a as se}from"./chunk-MQOUN7DP.js";import{a as de,b as fe}from"./chunk-D4XXG6A2.js";import"./chunk-TVWIYZG5.js";import"./chunk-XCXL4XHH.js";import{a as _e}from"./chunk-ID6WLUT2.js";import"./chunk-6GSJA3FK.js";import{a as le}from"./chunk-BF3I4LGD.js";import"./chunk-SDZD6YCY.js";import"./chunk-M4K5OVLF.js";import"./chunk-DPHI5PSG.js";import"./chunk-XQTXOEWR.js";import"./chunk-6NCSHYGI.js";import"./chunk-OGS4EVII.js";import"./chunk-6YB7A7ZH.js";import"./chunk-GBZAIAZB.js";import"./chunk-ODWDCLXK.js";import"./chunk-F4TUYCIO.js";import"./chunk-4ZSEYW2U.js";import"./chunk-SKYGTZSD.js";import"./chunk-4FC5X73U.js";import"./chunk-EEJJBISB.js";import"./chunk-W62UHBDW.js";import"./chunk-MG3YOV2C.js";import"./chunk-32PODRCK.js";import{b as ae,c as re}from"./chunk-MCZ27GCN.js";import{a as pe}from"./chunk-XCL4JOYZ.js";import"./chunk-EAHNU44C.js";import{b as ce}from"./chunk-3NZE6WSA.js";import"./chunk-NS43UFKU.js";import"./chunk-DS5QD6KN.js";import"./chunk-XMGSTBON.js";import"./chunk-VEYYY66H.js";import"./chunk-4I65K53K.js";import"./chunk-AZ3T5YEV.js";import"./chunk-7MLGAPHH.js";import{c as ne}from"./chunk-IP6ODCNA.js";import{b as te}from"./chunk-5BU3IDKS.js";import{f as ee}from"./chunk-I7ZNO67X.js";import{a as oe}from"./chunk-24VFFX2T.js";import"./chunk-7M6VBWZN.js";import"./chunk-C6P6X2N5.js";import"./chunk-YU6OV3L2.js";import{a as ie}from"./chunk-OTWAXCZF.js";import"./chunk-NKAP6NYB.js";import{a as Z}from"./chunk-KM3RDE6Q.js";import"./chunk-JY3RTIIU.js";import"./chunk-2SASL4UW.js";import"./chunk-B7M7KWVX.js";import{i as X}from"./chunk-PK2RARDK.js";import{$b as F,Cc as z,Gb as u,Ib as h,Kb as j,Kc as E,Lb as H,Lc as P,Mb as K,Nb as x,Ob as m,Pb as p,Qb as v,Rc as I,S as B,Xb as q,Ya as a,Zc as W,bc as s,ca as D,ia as T,ja as S,jb as O,jc as J,k as $,kc as R,lc as G,nb as Q,nc as Y,pb as U,qc as w,sa as L,sc as V,v as A}from"./chunk-ELCUH6OG.js";import{a as k,b as M,f as r,g as C,h as g}from"./chunk-IGH4DTA6.js";function ge(t,i){if(t&1&&v(0,"app-offering",4),t&2){let e=i.$implicit;x("details",e)}}function ue(t,i){if(t&1&&(m(0,"app-item-card-switch",1),U(1,ge,1,1,"ng-template",3),p()),t&2){let e=s();x("item",e.selectedEntity)}}function he(t,i){if(t&1&&v(0,"app-ui-icon",13),t&2){let e=s(2).$implicit,n=s(2);x("matTooltip",z("",e.npc==null?null:e.npc.characterName," is dateable"))("uiIcon",n.uiIcon.LOVE)}}function xe(t,i){if(t&1&&(m(0,"div",14),v(1,"app-ui-icon",15),w(2),E(3,"ingameDate"),p()),t&2){let e=s(2).$implicit,n=s(2);a(),x("uiIcon",n.uiIcon.BIRTHDAY),a(),V(" ",P(3,2,e.npc.birthday)," ")}}function ve(t,i){if(t&1&&(v(0,"app-item-icon",10),m(1,"div",11)(2,"div",12),w(3),u(4,he,1,3,"app-ui-icon",13),p(),u(5,xe,4,4,"div",14),p()),t&2){let e=s().$implicit;x("itemName",e.preferences.npc.iconName),a(3),V(" ",e.npc==null?null:e.npc.characterName," "),a(),h(e.npc!=null&&e.npc.isDateable?4:-1),a(),h(e.npc&&e.npc.birthday?5:-1)}}function ye(t,i){t&1&&w(0," Universal ")}function be(t,i){if(t&1){let e=q();m(0,"app-expandable",5,0)(2,"div",6),F("click",function(){T(e);let c=G(1);return S(c.toggle())}),m(3,"div",7),u(4,ve,6,4),u(5,ye,1,0),p(),v(6,"i",8),p(),m(7,"app-gifting-grid",9),F("itemClicked",function(c){T(e);let d=s(2);return S(d.showDetails(c))}),p()()}if(t&2){let e=i.$implicit,n=G(1);a(4),h(e.preferences.npc?4:-1),a(),h(e.preferences.mapKey==="ci_universal"?5:-1),a(),Y("down",!n.isOpen())("translate-y-[-3px]",n.isOpen())("up",n.isOpen()),a(),x("preferences",e.preferences)}}function we(t,i){if(t&1&&(m(0,"app-card",2),H(1,be,8,9,"app-expandable",5,j),p()),t&2){let e=s();a(),K(e.filteredAndSortedNpcs())}}var Re=(()=>{var i,e,n,c,d,y;let b=class b extends re{constructor(){super();C(this,i);C(this,e);C(this,n);C(this,c);C(this,d);C(this,y);this.npcFilter=W(N),this.uiIcon=Z,g(this,i,I(()=>this.npcFilter()?.searchValueChanges()??"")),g(this,e,I(()=>this.npcFilter()?.sortValueChanges()??"default")),g(this,n,me),g(this,c,D(ne)),g(this,d,L(void 0)),this.filteredAndSortedNpcs=I(()=>{let _=r(this,d).call(this)??[];if(!r(this,i)||!r(this,e))return _;let o=r(this,i).call(this).toLowerCase(),l=r(this,e).call(this);return r(this,n).call(this,_,o,l)}),g(this,y,D(te)),this.gifting$=A({gifts:r(this,y).fetchGiftingPreferences$(),npcs:r(this,y).fetchNPCs$()}).pipe(B(({gifts:_,npcs:o})=>{o=o.map(f=>M(k({},f),{characterName:ee(r(this,c).instant(f.characterName))}));let l=_.map(f=>({preferences:f,npc:o.find(Ce=>Ce.key===f.mapKey)}));return r(this,d)?.set(l),$(l)}))}};i=new WeakMap,e=new WeakMap,n=new WeakMap,c=new WeakMap,d=new WeakMap,y=new WeakMap,b.\u0275fac=function(o){return new(o||b)},b.\u0275cmp=O({type:b,selectors:[["app-gifting"]],viewQuery:function(o,l){o&1&&J(l.npcFilter,N,5),o&2&&R()},features:[Q],decls:5,vars:4,consts:[["expandableComponent",""],["listDetail","",3,"item"],[1,"text-xl"],["appDatabaseItemDetails",""],[3,"details"],["open","",1,"mb-8"],["expandableHeader","",1,"flex","justify-between","items-center","cursor-pointer",3,"click"],[1,"text-2xl","text-black","font-semibold","flex","items-center","gifting-portrait"],[1,"arrow"],[3,"itemClicked","preferences"],[1,"h-16","mr-3",3,"itemName"],[1,"flex","flex-col"],[1,"flex","gap-2","items-center"],[1,"!text-gifting","!h-6","!w-6",3,"uiIcon","matTooltip"],[1,"text-lg","flex","gap-2"],[1,"!h-6","!w-6",3,"uiIcon"]],template:function(o,l){if(o&1&&(m(0,"app-list-detail-container"),u(1,ue,2,1,"app-item-card-switch",1),v(2,"app-npc-filter"),u(3,we,3,0,"app-card",2),E(4,"async"),p()),o&2){let f;a(),h(l.selectedEntity?1:-1),a(2),h((f=P(4,2,l.gifting$))?3:-1,f)}},dependencies:[se,oe,le,de,ae,fe,ie,pe,ce,N,_e,X],styles:[`.gifting-portrait .app-item-icon>img{width:auto;height:100%;aspect-ratio:unset}
`],encapsulation:2});let t=b;return t})();export{Re as GiftingComponent};
